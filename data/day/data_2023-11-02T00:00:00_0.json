{
    "data": {
        "search": {
            "edges": [
                {
                    "node": {
                        "number": 16244,
                        "title": "Optimisation configuration Nginx",
                        "repository": {
                            "nameWithOwner": "betagouv/beta.gouv.fr",
                            "primaryLanguage": {
                                "name": "JavaScript"
                            }
                        },
                        "createdAt": "2023-11-02T10:14:06Z",
                        "mergedAt": "2024-01-08T19:26:44Z",
                        "url": "https://github.com/betagouv/beta.gouv.fr/pull/16244",
                        "state": "MERGED",
                        "author": {
                            "login": "jdauphant"
                        },
                        "editor": null,
                        "body": "En voyant les logs, la config n'\u00e9tait pas optimis\u00e9.\r\nJ'ai demand\u00e9 \u00e0 ChatGPT de corriger.\r\n\r\nhttps://chat.openai.com/share/225a4d0a-6b61-4266-bc8c-e4ead7ceb80c",
                        "comments": {
                            "nodes": []
                        },
                        "reviews": {
                            "edges": [
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Suggested change\n      \n    \n    \n      \n          \n            \n                expires 30d;\n          \n          \n            \n                expires 1d;",
                                                        "author": {
                                                            "login": "jdauphant"
                                                        },
                                                        "url": "https://github.com/betagouv/beta.gouv.fr/pull/16244#discussion_r1379879714",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "8400d5a",
                                                            "authoredDate": "2023-11-02T10:12:51Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": []
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "textMatches": [
                        {
                            "property": "body"
                        }
                    ]
                },
                {
                    "node": {
                        "number": 723,
                        "title": "chore: Add card validation logic for remote validation and co-badged cards",
                        "repository": {
                            "nameWithOwner": "primer-io/primer-sdk-ios",
                            "primaryLanguage": {
                                "name": "Swift"
                            }
                        },
                        "createdAt": "2023-11-02T16:29:39Z",
                        "mergedAt": "2023-11-07T13:02:53Z",
                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723",
                        "state": "MERGED",
                        "author": {
                            "login": "jnewc"
                        },
                        "editor": {
                            "login": "jnewc"
                        },
                        "body": "CHKT-1753\r\n\r\n\u2139\ufe0f **This is going to a feature branch, not master**\r\n\r\n# What this PR does\r\n\r\n* Adds logic for calling the BIN data API during card entry\r\n* Adds new delegate methods for async return of card networks during card entry\r\n* Unit tests for the above\r\n\r\n# Notable decisions & other stuff\r\n\r\n* Network layer has been modified to allow cancellation of requests\r\n\r\n# Before merging\r\n\r\n_QA_\r\n\r\n- [x] I manually tested this with a demo application (simulator)\r\n- [x] I manually tested this with a demo application (real device)\r\n- [x] I wrote unit tests\r\n",
                        "comments": {
                            "nodes": [
                                {
                                    "createdAt": "2023-11-02T16:31:07Z",
                                    "bodyText": "Warnings\n    \n  \n  \n      \u26a0\ufe0f\n      > Pull Request size seems relatively large. If this Pull Request contains multiple changes, please split each into separate PR will helps faster, easier review.\n    \n\n      \u26a0\ufe0f\n      Please assign someone aside from CODEOWNERS (@checkout-pci-reviewers) to review this PR.\n    \n  \n\n\n  Generated by \ud83d\udeab Danger Swift against eecc5e3",
                                    "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#issuecomment-1791073521",
                                    "author": {
                                        "login": "github-actions"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-02T18:33:34Z",
                                    "bodyText": "Appetize link: https://appetize.io/app/xe6zwfnmrffbs3rvhrvubsuvvq",
                                    "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#issuecomment-1791315023",
                                    "author": {
                                        "login": "github-actions"
                                    }
                                }
                            ]
                        },
                        "reviews": {
                            "edges": [
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": []
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Since PrimerCardData is public, it might be wise to give cardNetworkIdentifier a default value of nil, so as not to introduce a breaking change.",
                                                        "author": {
                                                            "login": "NQuinn27"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383077316",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "4dfeb2e",
                                                            "authoredDate": "2023-11-03T09:29:38Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Ah good catch, this was the intention but it slipped by me. Will change \ud83d\udc4d",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383120613",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "4dfeb2e",
                                                            "authoredDate": "2023-11-03T09:29:38Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Is card5Number naming intentional?",
                                                        "author": {
                                                            "login": "semirp"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383362849",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "1fd3918",
                                                            "authoredDate": "2023-11-06T11:05:25Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "Should we consider calling this PrimerCardState instead of PrimerCardValidationState? As we are not validating  anything here",
                                                        "author": {
                                                            "login": "semirp"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383378488",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "1fd3918",
                                                            "authoredDate": "2023-11-06T11:05:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "No! Changing \ud83d\ude35\u200d\ud83d\udcab",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383382747",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "1fd3918",
                                                            "authoredDate": "2023-11-06T11:05:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Yeah - I actually call the argument cardState in most places, so this makes sense. Will change \ud83d\udc4d",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1383383446",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "1fd3918",
                                                            "authoredDate": "2023-11-06T11:05:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Thanks for doing this, I try to do it all the time everywhere I see it. \ud83d\ude4f\ud83c\udffb",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384454532",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "Nooooicee! :)",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384457372",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb\ud83d\ude4f\ud83c\udffb",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384458738",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "I usually write it like this:\n// TODO: (BNI) comment\nBNI is for (B)oris (NI)koli\u0107 of course\nThis way you have this feature enabled :)\n\nyou save",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384464334",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "maybe extract this number 8 to some constants? don't bother doing it if you will never have repetition of this same number in same context",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384465380",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                },
                                                {
                                                    "node": {
                                                        "bodyText": "If this object represents the current string from the card number text field (not complete, but while the user is typing), that has to be validated, maybe consider a different name. Here is what GPT suggests :) https://chat.openai.com/share/3ff353ef-09a3-46b0-b4ea-1a01aa097b82",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384498279",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Good shout - I'll do this as part of CHKT-1885 (Modify card entry logic to account for eight digit constraint)",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384529303",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Do you mean for the class name or the property name? I was previously using cardFragment for the property name but changed it to cardNumber as it clashed with the naming for existing local valdiation\n@semirp what are you using in this case?",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384530688",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Ah nice, I have a saved search in Xcode to make sure I sort them all out before they get to master",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384538324",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Class name... But it could be both for more context, class and property names could be different... Not a must, just a nice-to-have",
                                                        "author": {
                                                            "login": "borisprimer"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384597921",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "CardNumberEntryState looks good - I think this with a Primer suffix \ud83d\udc4d",
                                                        "author": {
                                                            "login": "jnewc"
                                                        },
                                                        "url": "https://github.com/primer-io/primer-sdk-ios/pull/723#discussion_r1384644603",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "ba37dfd",
                                                            "authoredDate": "2023-11-06T14:12:16Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": []
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": []
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "textMatches": [
                        {
                            "property": "comments.body"
                        }
                    ]
                },
                {
                    "node": {
                        "number": 1631,
                        "title": "Don't require models to support more than 1 batch axis",
                        "repository": {
                            "nameWithOwner": "netket/netket",
                            "primaryLanguage": {
                                "name": "Python"
                            }
                        },
                        "createdAt": "2023-11-02T12:58:29Z",
                        "mergedAt": "2023-11-06T17:05:21Z",
                        "url": "https://github.com/netket/netket/pull/1631",
                        "state": "MERGED",
                        "author": {
                            "login": "inailuig"
                        },
                        "editor": null,
                        "body": "when using the jax operators.\r\nSomehow we missed this in https://github.com/netket/netket/pull/1506\r\n\r\nThanks to @jwnys for pointing it out.",
                        "comments": {
                            "nodes": [
                                {
                                    "createdAt": "2023-11-02T12:59:49Z",
                                    "bodyText": "Can you add a quick test?",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1790681121",
                                    "author": {
                                        "login": "PhilipVinc"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-02T13:24:44Z",
                                    "bodyText": "Codecov Report\nAll modified and coverable lines are covered by tests \u2705\n\nComparison is base (fe7629b) 82.43% compared to head (f3d0348) 80.87%.\nReport is 5 commits behind head on master.\n\nAdditional details and impacted files\n@@            Coverage Diff             @@\n##           master    #1631      +/-   ##\n==========================================\n- Coverage   82.43%   80.87%   -1.56%     \n==========================================\n  Files         278      279       +1     \n  Lines       16644    16757     +113     \n  Branches     2519     2536      +17     \n==========================================\n- Hits        13720    13552     -168     \n- Misses       2310     2622     +312     \n+ Partials      614      583      -31     \n\n\n\nFiles\nCoverage \u0394\n\n\n\n\n\nnetket/jax/_jacobian/jacobian_pytree.py\n100.00% <100.00%> (\u00f8)\n\n\n\nnetket/vqs/mc/kernels.py\n96.55% <100.00%> (\u00f8)\n\n\n\n\n... and 24 files with indirect coverage changes\n\n\u2614 View full report in Codecov by Sentry.\n\ud83d\udce2 Have feedback on the report? Share it here.",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1790719731",
                                    "author": {
                                        "login": "codecov"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-06T10:28:48Z",
                                    "bodyText": "I think it is easier if we ask users to provide models that accept a single batch dimension, and error if this is not the case. I agree it can be frustrating if it is not clear that this is required of the user's model. Is there a way to add a quick test on the model input to validate it, so to speak?",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1794513316",
                                    "author": {
                                        "login": "gcarleo"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-06T10:32:27Z",
                                    "bodyText": "Regardless, I don't feel very strongly about this, so if @gcarleo prefers to have the wrapper function, that's fine by me\n\nNo, I don't especially like this complicated wrapper function, it's just that it would be easier to remove if we add a model validation step. Still, I think we shouldn't ask users to write models that accept 2-axes batches, it's too much of a pain for the user",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1794519161",
                                    "author": {
                                        "login": "gcarleo"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-06T10:37:58Z",
                                    "bodyText": "Ok, then let's keep it this way then. Is it ok if we just go back to the original reshape - reshape?",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1794528910",
                                    "author": {
                                        "login": "PhilipVinc"
                                    }
                                },
                                {
                                    "createdAt": "2023-11-06T12:39:47Z",
                                    "bodyText": "fine... it's ugly to have these reshapes that could be summarized in a single function, but if it's commented... ok",
                                    "url": "https://github.com/netket/netket/pull/1631#issuecomment-1794730427",
                                    "author": {
                                        "login": "gcarleo"
                                    }
                                }
                            ]
                        },
                        "reviews": {
                            "edges": [
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "https://chat.openai.com/share/eefd3861-16f7-4850-ac63-998784264c7b",
                                                        "author": {
                                                            "login": "gcarleo"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1380066231",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "febbda8",
                                                            "authoredDate": "2023-11-02T12:53:35Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "not really, there is a call to logpsi in between",
                                                        "author": {
                                                            "login": "inailuig"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1380243854",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "febbda8",
                                                            "authoredDate": "2023-11-02T12:53:35Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "You should reshape also the \\sigma, not only the \\sigmap, to remove possible axes from the different chains.",
                                                        "author": {
                                                            "login": "jwnys"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1380246392",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "febbda8",
                                                            "authoredDate": "2023-11-02T12:53:35Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "For the sake of readability can we define an auxiliary small function that does this reshaping? Something like 'at_worst1d' (similar to atleast1d)",
                                                        "author": {
                                                            "login": "gcarleo"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1380250436",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "febbda8",
                                                            "authoredDate": "2023-11-02T12:53:35Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "@jwnys the chains should already be flattened here",
                                                        "author": {
                                                            "login": "inailuig"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1381202709",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "febbda8",
                                                            "authoredDate": "2023-11-02T12:53:35Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "let me know if this is too hacky.\nI felt like it would be good to check it in many places, and here we can do so for free (compared to adding a single dedicated test)\nAlso, if you check for ndim==2 there is quite a few places where the ndim=1, but apparently we always wrap it to support this here: \n  \n    \n      netket/netket/vqs/mc/mc_state/state.py\n    \n    \n        Lines 197 to 205\n      in\n      fe7629b\n    \n  \n  \n    \n\n        \n          \n               self._apply_fun = wrap_to_support_scalar( \n        \n\n        \n          \n                   nkjax.HashablePartial( \n        \n\n        \n          \n                       lambda model, pars, x, **kwargs: model.apply(pars, x, **kwargs), \n        \n\n        \n          \n                       model, \n        \n\n        \n          \n                   ) \n        \n\n        \n          \n               ) \n        \n\n        \n          \n            \n        \n\n        \n          \n           elif apply_fun is not None: \n        \n\n        \n          \n               self._apply_fun = wrap_to_support_scalar(apply_fun)",
                                                        "author": {
                                                            "login": "inailuig"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1381249472",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "Now that I think about it. I am not in favour of this change here.\nThe apply_fun should be wrapped, in case, inside of the variational state.\nOtherwise we end up with a complex patchwork of what supports and what does not support multiple axes.\nMy idea is that those operators & co should have the simplest as possible code, and then we can put a lot of those smarts in the constructors of MCState or similar.\nIf a user develops/uses his own variational state, he can wrap the callable he uses as apply fun by himself.\nAgain, the depths of netket's operators should stay as simple as possible..",
                                                        "author": {
                                                            "login": "PhilipVinc"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1382606186",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "I don't know how I feel about adding to netket 100 more lines, and a wrapper, to support a terrible habit.\nWe should rather instruct those 'users' in the right ways of vectorize their models rather than fix their bad behaviour ourself.\n(I feel netket's getting too many magics...)",
                                                        "author": {
                                                            "login": "PhilipVinc"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1382606827",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "netket has always corrected for this with the numba operators. It's just bizar not to do it now for the jax operator. This 'bad' behavior has already been encouraged by all previous versions of netket.\nIt just introduced easy mistakes (it took me time to understand that this is what was happening). Furthermore, all other libaries do the same: you have a single batch axis...",
                                                        "author": {
                                                            "login": "jwnys"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1382607271",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "COMMENTED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "I would be in favor of having requirements on models / user inputs rather than putting too many conversions inside of netket if possible. For example, why can't we require users to have their models take a single batch axis only?",
                                                        "author": {
                                                            "login": "gcarleo"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1383042457",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "So, to be honest I would be more in for adding the simple reshape - reshape trick we had at the beginning rather than this 'complicated' function, for the simple reason that I believe it to be uglier but more straightforward (we could add a comment) and easier to copy-paste around.\nalso because we need this in a single place...\nRegardless, I don't feel very strongly about this, so if @gcarleo prefers to have the wrapper function, that's fine by me",
                                        "comments": {
                                            "edges": [
                                                {
                                                    "node": {
                                                        "bodyText": "@jwnys a while ago we had decided to explicitly not require that models support scalar inputs, but we never made a choice on whether we would require more than 1 batch dimension or not, even though I guess my wording does indeed suggest we only require a single batch axis support, so that's the defecto standard now.\nWhat is missing are consistent tests to catch this.",
                                                        "author": {
                                                            "login": "PhilipVinc"
                                                        },
                                                        "url": "https://github.com/netket/netket/pull/1631#discussion_r1383076279",
                                                        "originalCommit": {
                                                            "abbreviatedOid": "e8f1892",
                                                            "authoredDate": "2023-11-03T07:45:25Z"
                                                        }
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "node": {
                                        "state": "APPROVED",
                                        "bodyText": "",
                                        "comments": {
                                            "edges": []
                                        }
                                    }
                                }
                            ]
                        }
                    },
                    "textMatches": [
                        {
                            "property": "comments.body"
                        },
                        {
                            "property": "body"
                        }
                    ]
                }
            ],
            "pageInfo": {
                "endCursor": "Y3Vyc29yOjM=",
                "hasNextPage": false,
                "hasPreviousPage": false,
                "startCursor": "Y3Vyc29yOjE="
            },
            "issueCount": 3
        }
    }
}